(this.webpackJsonpralph=this.webpackJsonpralph||[]).push([[0],{175:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),r=a.n(n);const s=({size:e,bp:t="sm",children:a,className:n=""})=>r.a.createElement("div",{className:`col-${t}-${e} ${n}`},a);t.b=s},176:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(0),r=a.n(n);const s=({className:e="",children:t})=>r.a.createElement("div",{className:`row ${e}`},t);t.b=s},219:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(228),r=a.n(n),s=a(0),l=a(24),i=a(18),c=a(14),m=a(183),o=a(25);const u=r()(e=>Object(i.a)(void 0)),d=e=>{const t=u(e),a=Object(m.a)().initiateRequest,n=()=>{Object(c.a)(e).then(e=>{t.next(e)})},r=t=>(r,s,l)=>{return a(t(e,r),l,()=>{n(),s()})};Object(s.useEffect)(n,[]);const i=Object(s.useMemo)(Object(o.a)(t),[t]);return{resource:Object(l.useSubscription)(i),GET:n,POST:r(c.d),PUT:r(c.e),PATCH:r(c.c),DELETE:r(c.b)}}},220:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(0),r=a.n(n),s=a(194),l=a.n(s),i=a(7),c=a.n(i),m=a(2),o=(a(252),a(188)),u=a(186),d=a(200);const E=Object(m.a)("object-history"),b=({endpoint:e})=>r.a.createElement(d.a,{endpoint:e},e=>r.a.createElement("div",{className:E(),"data-testid":"object-history"},l()(e.history.content,e=>r.a.createElement(c.a,{key:e.lastModified},r.a.createElement(i.AUcardInner,null,r.a.createElement(u.a,{textLabel:"Entity Type"},e.entityType),r.a.createElement(u.a,{textLabel:"Entity Unique Name"},e.entityUniqueName),r.a.createElement(u.a,{textLabel:"Revision"},e.revision),r.a.createElement(u.a,{textLabel:"Revision Type"},e.revisionType),r.a.createElement(u.a,{textLabel:"Last Modified"},Object(o.a)(e.lastModified)),r.a.createElement(u.a,{textLabel:"Changes"},e.changes.map((e,t)=>r.a.createElement("div",{key:t},e))))))))},224:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(6),l=a(10),i=a(11),c=a(189),m=a(218),o=a(186),u=a(194),d=a.n(u),E=a(208),b=a.n(E),p=a(180),O=a.n(p),g=a(182);const h=({id:e})=>{const t=Object(g.a)(`${m.a.TransactionLogs}/${e}`).response;if(void 0===t)return null;const a=t;return r.a.createElement("main",null,r.a.createElement("div",null,r.a.createElement(i.a,null,"Transaction Details"),d()(a.transactionLog,(e,t)=>r.a.createElement(o.a,{textLabel:b()(t)},e))),r.a.createElement("div",null,r.a.createElement(i.a,null,"Changes"),a.changes.map(e=>r.a.createElement("div",null,d()(e,(e,t)=>O()(e)?r.a.createElement(o.a,{textLabel:b()(t)},d()(e,e=>r.a.createElement("div",null,e))):r.a.createElement(o.a,{textLabel:b()(t)},e))))))};var j=a(16),f=a.n(j);t.default=({endpoint:e,match:t,searchOptions:a})=>{const n=[{title:"Timestamp",key:"timestamp"},{title:"User Email",key:"userEmail"},{title:"Command",key:"command"},{title:"View",render:({id:e})=>r.a.createElement(f.a,{linkComponent:s.a,link:`${t.url}/${e}`},"View Details")}];return r.a.createElement(l.d,null,r.a.createElement(l.b,{path:`${t.path}/:id`,render:e=>r.a.createElement(h,Object.assign({id:e.match.params.id},e))}),r.a.createElement(l.b,{render:()=>r.a.createElement("main",null,r.a.createElement(i.a,null,"Transaction Logs"),r.a.createElement(c.a,{endpoint:e,columns:n,searchOptions:a}))}))}},248:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var n=a(0),r=a.n(n),s=a(176),l=a(175),i=a(11),c=a(186),m=a(16),o=a.n(m),u=a(46),d=a(188);const E=({isMyProfile:e=!1,user:t})=>r.a.createElement(s.b,null,r.a.createElement(l.b,{size:4},r.a.createElement(i.a,null,"User details"),r.a.createElement(o.a,{onClick:u.a},"Edit")),r.a.createElement(l.b,{size:5},r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{textLabel:"Full name"},t.firstname," ",t.surname),r.a.createElement(c.a,{textLabel:"Username"},t.username),r.a.createElement(c.a,{textLabel:"Email"},t.email),r.a.createElement(c.a,{textLabel:"Default Organisation"},t.defaultOrganisationName),!e&&r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{textLabel:"Failed Login Count"},t.failedLoginCount),r.a.createElement(c.a,{textLabel:"Failed MFA Count"},t.failedMFACount)),t.previousLoginTimestamp&&r.a.createElement(c.a,{textLabel:"Previous Login Time"},Object(d.a)(t.previousLoginTimestamp)),t.lastUpdateUserName&&r.a.createElement(c.a,{textLabel:"Last updated by"},t.lastUpdateUserName," (",t.lastUpdateUserEmail,")"))))},249:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(28),r=a(16),s=a.n(r),l=a(48),i=a(179),c=a(0),m=a.n(c),o=a(185),u=a(47),d=a(184),E=a(175),b=a(11),p=a(176),O=a(22),g=a(46),h=a(219),j=a(178);const f=o.object().shape({firstname:o.string().required("First name is required"),surname:o.string().required("Surname is required"),email:o.string().required("Email is required")}),v=({userId:e})=>{const t=`${j.b.Users}/${e}`,a=Object(h.a)(t),r=a.resource,o=a.PUT,v=Object(c.useState)(""),$=Object(n.a)(v,2),U=$[0],x=$[1],y=Object(O.a)().authDetails;if(void 0===r)return null;return m.a.createElement(i.e,{initialValues:{id:r.id,expectedVersion:r.version,firstname:r.firstname,surname:r.surname,email:r.email,defaultOrganisationId:r.defaultOrganisationId},onSubmit:e=>{o({id:e.id,expectedVersion:e.expectedVersion,firstname:e.firstname,surname:e.surname,email:e.email,defaultOrganisationId:e.defaultOrganisationId},()=>{Object(g.b)(),Object(g.b)()},e=>{x(e.message)})},validationSchema:f},()=>m.a.createElement(p.b,null,m.a.createElement(E.b,{size:4},m.a.createElement(b.a,null,"User details"),m.a.createElement(s.a,{onClick:()=>{Object(g.b)()}},"Cancel")),m.a.createElement(E.b,{size:5},m.a.createElement(i.d,null,m.a.createElement(d.a,{textLabel:"First name",name:"firstname"}),m.a.createElement(d.a,{textLabel:"Last name",name:"surname"}),m.a.createElement(d.a,{textLabel:"Email",name:"email"}),y.userId===r.id&&m.a.createElement("div",{className:"au-form-group"},m.a.createElement(l.AUlabel,{htmlFor:"defaultOrganisation",text:"Default Organisation"}),m.a.createElement(i.b,{as:"select",id:"defaultOrganisation",className:"au-select",name:"defaultOrganisationId"},r.organisations.map(e=>m.a.createElement("option",{key:e.organisationId,value:e.organisationId},e.organisationName)))),m.a.createElement(u.a,{message:U}),m.a.createElement(s.a,{type:"submit"},"Save")))))}},250:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a.n(n),s=a(176),l=a(175),i=a(11);const c=({organisations:e})=>r.a.createElement(s.a,null,r.a.createElement(l.a,{size:4},r.a.createElement(i.a,null,"Organisations")),r.a.createElement(l.a,{size:8},e.map(e=>r.a.createElement("div",{key:e.organisationId},e.organisationName))))},251:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),r=a.n(n),s=a(176),l=a(175),i=a(11),c=a(220),m=a(178),o=a(1);const u=({userId:e})=>r.a.createElement(s.b,null,r.a.createElement(l.b,{size:4},r.a.createElement(i.a,null,"History")),r.a.createElement(l.b,{size:5},r.a.createElement(c.a,{endpoint:`${m.b.Users}/${e}/${o.b.History}`})))},252:function(e,t,a){},255:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),r=a.n(n),s=a(11),l=a(223);const i=({username:e,passwordFragment:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,null,"A new account has been created, please note down the following details and pass them to the user:"),r.a.createElement(l.AUcallout,{title:e},"Username of the newly created user"),r.a.createElement(l.AUcallout,{title:t},"Second half of the user's passowrd"))},257:function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e.ExpectedVersion="expectedVersion"}(n||(n={}))},444:function(e,t,a){},445:function(e,t,a){},451:function(e,t,a){"use strict";a.r(t);var n=a(16),r=a.n(n),s=a(0),l=a.n(s),i=a(6),c=a(10),m=a(11),o=a(189),u=a(20),d=a(1),E=a(22),b=a(2),p=a(28);var O=a(179),g=a(48),h=a(14),j=a(183),f=a(29),v=a(46),$=a(30),U=a(178),x=a(47),y=a(50),N=a(303),k=a.n(N),A=a(255);const L=Object(b.a)("add-user");var S;!function(e){e.OrganisationId="organisationId",e.Email="email",e.Firstname="firstname",e.Surname="surname"}(S||(S={}));const F=({org:e})=>{const t=Object(j.a)().initiateRequest,a=Object(s.useState)(""),n=Object(p.a)(a,2),i=n[0],c=n[1],o=Object(s.useState)(!1),u=Object(p.a)(o,2),d=u[0],E=u[1],b=Object(s.useState)(""),N=Object(p.a)(b,2),F=N[0],I=N[1],w=Object(s.useState)(void 0),C=Object(p.a)(w,2),T=C[0],V=C[1],R=Object(s.useState)(void 0),z=Object(p.a)(R,2),q=z[0],D=z[1],M=k()(e=>Object(h.a)(`${U.b.CheckPresent}?userEmail=${encodeURIComponent(e)}`).then(e=>{I(e.userId),V(!0)}).catch(()=>{V(!1)}),500),P={[S.OrganisationId]:e.id,[S.Email]:"",[S.Firstname]:"",[S.Surname]:""};return l.a.createElement("main",{className:L()},l.a.createElement(m.a,null,"Add a User to ",e.name),l.a.createElement(f.b,{condition:d},l.a.createElement(y.a,{message:"User has been added to organisation"})),l.a.createElement(x.a,{message:i}),l.a.createElement(O.e,{initialValues:P,onSubmit:(a,n)=>{T?(a=>{const n=Object(h.e)(`${$.a.Organisations}/${e.id}/users`,{id:e.id,expectedVersion:e.version,userId:F});t(n,e=>{c(e.message)},()=>{c(""),E(!0),Object(v.b)(),Object(v.b)()})})():(e=>{const a=Object(h.d)(`${U.b.Users}`,e);t(a,e=>{c(e.message)},e=>{D(e),Object(v.b)()})})(a)}},()=>l.a.createElement(O.d,{className:L("form")},l.a.createElement(g.AUlabel,{text:"User Email",htmlFor:"email"}),l.a.createElement(O.b,{className:"au-text-input",name:"email",validate:M}),!1===T&&l.a.createElement(l.a.Fragment,null,l.a.createElement(g.AUlabel,{text:"Firstname",htmlFor:S.Firstname}),l.a.createElement(O.b,{className:"au-text-input",name:S.Firstname}),l.a.createElement(g.AUlabel,{text:"Surname",htmlFor:S.Surname}),l.a.createElement(O.b,{className:"au-text-input",name:S.Surname})),q&&l.a.createElement(A.a,{username:q.username,passwordFragment:q.passwordFragment}),void 0!==T&&l.a.createElement(r.a,{type:"submit"},"Add user"))))};var I=a(31),w=a(248),C=a(249),T=a(250),V=a(439),R=a.n(V),z=a(176),q=a(175);const D=({id:e})=>l.a.createElement(z.a,null,l.a.createElement(q.a,{size:4},l.a.createElement(m.a,null,"Recent activity")),l.a.createElement(q.a,{size:8},l.a.createElement("section",null,l.a.createElement("p",null,l.a.createElement("i",null)),l.a.createElement(R.a,{link:`${d.a.Dashboard}${d.a.Users}/${e}/activity`,linkComponent:i.a,text:"See this user's recent activity"}))));var M=a(19),P=a(181),Z=a(257),H=a(223);const J=({user:e})=>{const t=Object(j.a)().initiateRequest,a=Object(s.useState)(""),n=Object(p.a)(a,2),i=n[0],c=n[1],m=Object(s.useState)(null),o=Object(p.a)(m,2),u=o[0],d=o[1],E=Object(h.e)(`${U.b.Users}/${e.id}/password-reset`,{id:e.id,expectedVersion:e.version}),b=e=>{c(e.message)},O=e=>{Object(v.b)(),c(""),d(e)};return l.a.createElement("div",null,l.a.createElement(g.AUhintText,{text:"If this user has forgotten their password, you can reset it here:"}),l.a.createElement(r.a,{className:"au-btn--type-error",onClick:()=>{c(""),d(null),t(E,b,O)}},"Reset this user's password"),i&&l.a.createElement(x.a,{message:i}),u&&l.a.createElement(H.AUcallout,{title:null===u||void 0===u?void 0:u.passwordFragment},"Second half of the user's new password"))},G=Object(b.a)("user-actions"),B=({user:e,org:t})=>{const a=Object(s.useState)(e),n=Object(p.a)(a,2),i=n[0],c=n[1],o=Object(s.useState)(""),u=Object(p.a)(o,2),d=u[0],E=u[1],b=Object(j.a)().initiateRequest,O=e=>{E(e.message)},y=`${U.b.Users}/${e.id}`;return l.a.createElement(z.a,null,l.a.createElement(q.a,{size:4},l.a.createElement(m.a,null,"Actions")),l.a.createElement(q.a,{size:8},l.a.createElement("section",{className:G("actions-container")},l.a.createElement(f.a,{condition:i.locked},l.a.createElement(g.AUhintText,{text:"This user is currently locked. Unlock their account:"}),l.a.createElement(r.a,{className:"au-btn--type-success",onClick:()=>{E("");const t=Object(h.c)(`${y}/reactivate?${Z.a.ExpectedVersion}=${e.version}`);b(t,O,()=>{c(e=>Object(M.a)({},e,{locked:!1})),Object(v.b)()})}},"Reactivate this user")),l.a.createElement(P.a,null,l.a.createElement(f.a,{condition:i.suspended},l.a.createElement(g.AUhintText,{text:"This user is currently suspended. Unsuspend their account:"}),l.a.createElement(r.a,{className:"au-btn--type-success",onClick:()=>{E("");const t=Object(h.c)(`${y}/unsuspend?${Z.a.ExpectedVersion}=${e.version}`);b(t,O,()=>{c(e=>Object(M.a)({},e,{suspended:!1})),Object(v.b)()})}},"Unsuspend this user")),l.a.createElement(f.a,{condition:!i.suspended},l.a.createElement(g.AUhintText,{text:"Suspend this user account:"}),l.a.createElement(r.a,{className:"au-btn--type-error",onClick:()=>{E("");const t=Object(h.c)(`${y}/suspend?${Z.a.ExpectedVersion}=${e.version}`);b(t,O,()=>{c(e=>Object(M.a)({},e,{suspended:!0})),Object(v.b)()})}},"Suspend this user"))),l.a.createElement(P.a,null,l.a.createElement(J,{user:e})),l.a.createElement(P.a,null,l.a.createElement(r.a,{className:`${G("reset-password-btn")} au-btn--type-error`,onClick:()=>{const a=Object(h.b)(`${$.a.Organisations}/${t.id}/users/${e.id}?${Z.a.ExpectedVersion}=${t.version}`);b(a,O,()=>{Object(v.b)(2)})}},"Remove this user from ",t.name))),l.a.createElement(x.a,{message:d})),l.a.createElement(x.a,{message:d}))};var K=a(65),Q=a(244),W=a(441),X=a.n(W),Y=a(56),_=a.n(Y),ee=a(191),te=a.n(ee),ae=a(182);const ne=e=>{const t=X()(e,_.a);return te()(t)},re=({userId:e,org:t})=>{const a=Object(s.useState)(""),n=Object(p.a)(a,2),i=n[0],c=n[1],o=Object(s.useState)(""),d=Object(p.a)(o,2),E=d[0],b=d[1],g=Object(j.a)().initiateRequest,f=`${$.a.Organisations}/${t.id}/user-roles`,N=Object(ae.a)(`${U.b.Users}/${e}`),k=N.response,A=N.reFetch;if(void 0===k)return null;const L=(e=>{const t={[u.a.OrganisationUser]:!1,[u.a.OrganisationAdmin]:!1,[u.a.ZoneManagerAdmin]:!1,[u.a.RegistrarAdmin]:!1};return e.forEach(e=>{t[e]=!0}),t})((e=>{const a=e.find(e=>e.organisationId===t.id);return void 0!==a?a.organisationRoles:[]})(k.organisations));return l.a.createElement(z.a,null,l.a.createElement(q.a,{size:4},l.a.createElement(m.a,null,"Roles")),l.a.createElement(q.a,{size:8},l.a.createElement(O.e,{initialValues:L,onSubmit:(a,{resetForm:n})=>{c(""),b("");const r=Object(h.c)(f,{id:t.id,expectedVersion:t.version,userId:e,roles:ne(a)});g(r,e=>{c(e.message),Object(v.b)(),n({values:L})},()=>{b(`User's roles in ${t.name} have been updated`),A(),Object(v.b)()})}},({values:e})=>l.a.createElement(O.d,null,K.b.map(t=>{const a=e[t.systemName];return l.a.createElement(O.b,{key:t.displayName,as:Q.AUcheckbox,label:t.displayName,name:t.systemName,id:t.systemName,block:!0,checked:a})}),l.a.createElement(y.a,{message:E}),l.a.createElement(x.a,{message:i}),l.a.createElement(r.a,{"data-testid":"change-roles-btn",type:"submit"},"Update Roles")))))};a(444);var se=a(251),le=a(224),ie=a(219);const ce=Object(b.a)("user-profile");var me=e=>{let t=e.userId,a=e.org,n=Object(I.a)(e,["userId","org"]);const r=Object(ie.a)(`${U.b.Users}/${t}`).resource;return void 0===r?null:l.a.createElement("main",{className:ce()},l.a.createElement(c.d,null,l.a.createElement(c.b,{path:`${n.match.path}/edit`,render:e=>l.a.createElement(C.a,Object.assign({userId:r.id},e))}),l.a.createElement(c.b,{path:n.match.path,render:e=>l.a.createElement(w.a,Object.assign({user:r},e))})),l.a.createElement(T.a,{organisations:r.organisations}),l.a.createElement(D,{id:r.id}),a&&l.a.createElement(l.a.Fragment,null,l.a.createElement(re,{userId:r.id,org:a}),l.a.createElement(B,{user:r,org:a})),l.a.createElement(se.a,{userId:r.id}),l.a.createElement(le.default,Object.assign({endpoint:`${U.b.Users}/${r.id}/transactions`,searchOptions:[{value:"searchCommand",text:"Command"}]},n)))};a(445);a.d(t,"UserTable",(function(){return ue}));const oe=Object(b.a)("user-management"),ue=({org:e,match:t})=>{const a=Object(E.a)().authDetails,n=e?`${U.b.Users}?searchOrganisationId=${e.id}`:U.b.Users,s=[{title:"Username",key:"username",width:"10"},{title:"Name",key:"name",width:"20"},{title:"Email",key:"email",width:"20"},{title:"View Details",width:"10",render:e=>l.a.createElement(r.a,{linkComponent:i.a,link:`${t.url}/${e.id}`},"Details")}];return l.a.createElement(c.d,null,e&&l.a.createElement(c.b,{path:`${t.path}/${d.b.AddUser}`,render:t=>l.a.createElement(F,Object.assign({org:e},t))}),l.a.createElement(c.b,{path:`${t.path}/:id`,render:t=>{const a=t.match.params.id;return(e=>{if(!e)return!1;const t=e.split("-"),a=5===t.length,n=Object(p.a)(t,5),r=n[0],s=n[1],l=n[2],i=n[3],c=n[4];return a&&8===r.length&&4===s.length&&4===l.length&&4===i.length&&12===c.length})(a)?l.a.createElement(me,Object.assign({userId:a,org:e},t)):null}}),l.a.createElement(c.b,{render:()=>l.a.createElement("main",{className:oe()},e?l.a.createElement(l.a.Fragment,null,l.a.createElement(m.a,null,"Users in ",e.name),(a.roles.includes(u.a.OrganisationAdmin)||a.roles.includes(u.a.ZoneManagerAdmin)||a.roles.includes(u.a.RegistrarAdmin))&&l.a.createElement(l.a.Fragment,null,l.a.createElement(r.a,{className:oe(d.b.AddUser),link:`${t.url}/${d.b.AddUser}`,linkComponent:i.a},"Add User"))):l.a.createElement(m.a,null,"All users"),l.a.createElement(o.a,{endpoint:n,columns:s,searchOptions:[{value:"searchEmail",text:"Email"},{value:"searchName",text:"User's name"},{value:"searchAccessZoneName",text:"Access Zone Name"}]}))}))};t.default=ue}}]);
//# sourceMappingURL=0.1691781a.chunk.js.map